!function(){function t(n,e,i){function o(s,r){if(!e[s]){if(!n[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=e[s]={exports:{}};n[s][0].call(u.exports,function(t){return o(n[s][1][t]||t)},u,u.exports,t,n,e,i)}return e[s].exports}for(var a="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}return t}()({1:[function(t,n,e){(function(t){(function(){var e,i=function(t,n){return function(){return t.apply(n,arguments)}};e=function(){function t(){this.hasToken=i(this.hasToken,this),this.createIdentification=i(this.createIdentification,this),this.checkIdentificationCallback=i(this.checkIdentificationCallback,this),this.checkIdentification=i(this.checkIdentification,this),this.getIdentification=i(this.getIdentification,this),this.login=i(this.login,this),this.me=void 0,this.identification=void 0,this.getIdentification(),this.getLoginStatus(),this.bind()}return t.prototype.bind=function(){return bind(".button-github-login","click",function(t){return function(){return t.login("github")}}(this)),bind(".button-facebook-login","click",function(t){return function(){return t.login("facebook")}}(this)),bind(".button-logout","click",this.logout)},t.prototype.login=function(t){return redirect(AUTH_URL+t)},t.prototype.logout=function(){return Cookies.set("_ggid","",{expires:0,path:"/",domain:".unlink.men"}),setTimeout(function(){return redirect("/")},500)},t.prototype.getLoginStatus=function(){return this.hasToken()?get(API_URL+"me",function(t){return"connected"===t.status?(this.me=t.user,this.me.verified?View.switch("verified-user"):View.switch("user")):(Cookies.set("_ggid","",{expires:0,path:"/",domain:".unlink.men"}),View.switch("guest"))}.bind(this),{token:ACCESS_TOKEN}):View.switch("guest")},t.prototype.getIdentification=function(){return null===localStorage.getItem("identification")?this.createIdentification():(this.identification=localStorage.getItem("identification"),this.checkIdentification(this.identification))},t.prototype.checkIdentification=function(t){return post(API_URL+"client/check",this.checkIdentificationCallback,{identification:t})},t.prototype.checkIdentificationCallback=function(t){if(void 0===t.message)return this.createIdentification()},t.prototype.createIdentification=function(){return post(API_URL+"client",function(t){var n;return n=t.data.identification,localStorage.setItem("identification",n),this.identification=n}.bind(this))},t.prototype.hasToken=function(){return void 0!==ACCESS_TOKEN&&""!==ACCESS_TOKEN},t}(),t.User=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,n,e){t("./../view/View"),t("./../view/PostView"),t("./../view/PostFacebookCommentView"),t("./../component/User"),t("./../partial/Post"),t("./../partial/PostLike")},{"./../component/User":1,"./../partial/Post":3,"./../partial/PostLike":4,"./../view/PostFacebookCommentView":5,"./../view/PostView":6,"./../view/View":7}],3:[function(t,n,e){(function(t){(function(){var e,i=function(t,n){return function(){return t.apply(n,arguments)}};e=function(){function t(){this.loadFacebookCommentsCallback=i(this.loadFacebookCommentsCallback,this),this.loadFacebookComments=i(this.loadFacebookComments,this),this.callback=i(this.callback,this),this.loadPost=i(this.loadPost,this),this.container=$("#post"),this.url=API_URL+"post",this.post_id=inputGet("id"),this.post_key=inputGet("key"),this.post_pid=void 0,this.loadPost()}return t.prototype.loadPost=function(){return""!==this.post_id?(this.setBreadcrumb(PAGE_NAME+this.post_id),get(this.url,this.callback,{id:this.post_id,token:ACCESS_TOKEN})):""!==this.post_key?(this.setBreadcrumb(this.post_key),get(this.url,this.callback,{key:this.post_key})):redirect("/")},t.prototype.callback=function(t){return t.success&&void 0!==t.data.post?""===this.post_id&&void 0!==t.data.post.id?redirect("/post/?id="+t.data.post.id):(PostView.main.create(t.data.post),void 0!==t.data.post.facebook_pid?(this.post_pid=t.data.post.facebook_pid,this.loadFacebookComments()):void 0):View.message.page_not_found(this.container)},t.prototype.setBreadcrumb=function(t){return $("#breadcrumb-current").text("#"+t)},t.prototype.loadFacebookComments=function(t){var n;return null==t&&(t=""),n={pid:this.post_pid},""!==t&&(n.after=t),get(this.url+"/comments",this.loadFacebookCommentsCallback,n)},t.prototype.loadFacebookCommentsCallback=function(t){if(t.success&&void 0!==t.data.comments)return PostFacebookCommentView.main.create(t.data)},t}(),t.Post=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(t,n,e){(function(t){(function(){var e,i=function(t,n){return function(){return t.apply(n,arguments)}};e=function(){function t(){this.handlePostLike=i(this.handlePostLike,this),this.url=API_URL+"post",this.bind()}return t.prototype.bind=function(){return bind(".button-like","click",this.handlePostLike)},t.prototype.handlePostLike=function(t){var n,e;return void 0===User.me?$("#login-modal").modal("show"):(n=$(t.currentTarget),e=n.attr("data-id"),post(this.url+"/like/"+e,function(t){return t.success?View.like_button.updateLikeCount(n,e,t.data.likes,t.data.liked):alert(MESSAGE.something_wrong)}.bind(this),{},!0))},t}(),t.PostLike=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,n,e){(function(t){(function(){var e;e=function(){function t(){}return t.prototype.main={parent:$("#post-comment"),loading:$("#post-comment-progress"),after:"",create:function(t,n){var e,i,o,a;if(null==n&&(n=""),this.loading.show(),0===t.comments.length)this.removeButton();else{for(a=t.comments,i=0,o=a.length;i<o;i++)e=a[i],n+=this.__comment(e);void 0!==t.after&&""!==t.after?this.after=t.after:this.removeButton(),0===$("#button-load-more").length&&(n+=this.__loadMore(t.after),this.bind()),0===$("#post-comment-wrapper").length?(n=this.__commentWrapper(n),this.parent.append(n)):$(n).insertBefore("#button-load-more"),$(".fake-avatar").each(function(t){if("none"===$(this).css("background-image"))return $(this).gixi()})}return $(".comment").linkify(),this.loading.hide()},bind:function(){return bind("#button-load-more","click",function(t){return function(){return t.loadMore()}}(this))},loadMore:function(){return Post.loadFacebookComments(this.after)},removeButton:function(){return $("#button-load-more").remove()},__comment:function(t){var n;return n=$("<div/>").html(t.message).text(),""===n&&(n="[Sticker]"),'<div class="fake-avatar"></div>\n<div class="comment">\n  <strong>\n    <a href="https://facebook.com/'+t.id+'" target="_blank" style="background: none;"><mark>'+t.from.name+"</mark></a>\n  </strong><br />\n  "+n+"\n</div>\n<hr />"},__commentWrapper:function(t){return'<div class="alert" style="background: white;" id="post-comment-wrapper">\n  <h4 class="alert-heading">Facebook comments</h4>\n  <hr />\n  '+t+"\n</div>"},__loadMore:function(){return'<button type="button" class="btn btn-primary btn-large btn-block" id="button-load-more" style="margin-bottom: 20px;">Load more</button>'}},t}(),t.PostFacebookCommentView=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,n,e){(function(t){(function(){var e;e=function(){function t(){}return t.prototype.main={parent:$("#post"),reloaded:inputGet("r",0),create:function(t,n){if(null==n&&(n=""),t.content=this.handleContent(t),void 0===t.id&&(n+=this.__postInfo(t)),n+=this.__post(t),void 0!==t.id&&(n+=this.__postLiks(t)),"published"===t.state&&(n+=this.__socialCount(t)),this.parent.html(n),this.parent.linkify(),"queuing"===t.state)return $("#countdown").xxcountdown({callback:function(n){return function(){return 0===n.reloaded?$(location).attr("href","/post/?key="+t.key+"&r=1"):($("#post-state").text(TEXT.failed),$("#countdown").text(MESSAGE.countdown_failed),document.title=MESSAGE.countdown_failed)}}(this)})},handleContent:function(t,n){var e;return null==n&&(n=""),t.title=this.__postTitle(t),void 0!==t.reply_to&&(n+=this.__replyTo(t.reply_to)),"text"!==(e=t.type)&&"link"!==e&&"code"!==e||(n+=t.content),void 0!==t.hashtag&&(n+="<br />"+t.hashtag),"image"===t.type&&(n+=this.__postImage(t.image)),"code"===t.type&&(n+=this.__postCode(t.code)),n},handleState:function(t){return"published"===t?TEXT.published:"unpublished"===t?TEXT.unpublished:"denied"===t?TEXT.denied:"pending"===t?TEXT.pending:"analysing"===t?TEXT.analysing:"queuing"===t?TEXT.queuing:"failed"===t?TEXT.failed:void 0},handleCountDown:function(t,n){return null==n&&(n=""),"queuing"===t.state&&(n=this.__countDown(t.countdown)),n},__replyTo:function(t){return'RE: <a href="/post/'+t+'/">#'+PAGE_NAME+t+"</a>&nbsp;"},__postImage:function(t){return'<div style="margin-top: 24px;"><img src="'+t+'" class="img-responsive" /></div>'},__postCode:function(t){return'<pre style="margin-top: 24px;">'+t+"</pre>"},__postTitle:function(t){var n,e;return e=void 0!==t.id?PAGE_NAME+t.id:t.key,n=void 0!==t.id?this.__datetime(t.published_at):"","<strong>\n  <mark>#"+e+"</mark>\n</strong><br />"+n+"<br />"},__datetime:function(t){return'<small style="font-size:14px;">Published at '+t+"</small>"},__postInfo:function(t){return'<div class="alert alert-block" id="post-info">\n  <p>\n    '+TEXT.state+': <span id="post-state">'+this.handleState(t.state)+"</span><br />\n    "+TEXT.created_at+": "+t.created_at+"\n    "+this.handleCountDown(t)+"\n  </p>\n</div>"},__postLiks:function(t,n){var e,i,o;null==n&&(n=""),i=t.links;for(e in i)o=i[e],n+=this.__link(e,o),n+="&nbsp;";return'<div class="alert alert-success alert-block" id="post-links">\n  <h4 class="alert-heading">Post links</h4>\n  <hr />\n  <p>'+n+"</p>\n</div>"},__link:function(t,n){return'<a class="btn btn-link" href="'+n+'" target="_blank">\n  <i class="fa fa-external-link-square" aria-hidden="true"></i> '+ucfirst(t)+"\n</a>"},__post:function(t){var n;return n="published"===t.state?View.like_button.create(t):"",'<div class="post old-school-scroll">\n  <div class="content">\n    <ul>\n      <li>\n        '+t.title+'\n        <span class="post-content">'+t.content+"</span>\n        <br />\n        "+n+"\n      </li>\n    </ul>\n  </div>\n</div>"},__socialCount:function(t){return'<div class="alert alert-block alert-info">\n  <h4 class="alert-heading">Facebook reaction counts</h4>\n  <hr />\n  <div class="fb-social-count">\n    <br />\n    <img src="/images/old/like.gif" /> '+t.fb_likes+'\n    <img src="/images/old/comment.gif" /> '+t.fb_comments+'\n    <img src="/images/old/share.gif" /> '+t.fb_shares+"\n  </div>\n</div>"},__countDown:function(t){return"<br />"+TEXT.publish_countdown+': <span id="countdown" data-timestamp="'+t+'"></span>'}},t}(),t.PostView=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,n,e){(function(t){(function(){var e;e=function(){function t(){}return t.prototype.switch=function(t){return"verified-user"===t?($("body").removeClass("guest").addClass("user verified"),this.navbar.user()):"user"===t?($("body").removeClass("guest").addClass("user"),this.navbar.user()):($("body").removeClass("user verified").addClass("guest"),this.navbar.guest())},t.prototype.navbar={parent:$("#main-menu-left"),user:function(){var t;return t='<li class="dropdown" id="preview-menu">\n  <a class="dropdown-toggle" data-toggle="dropdown" href="#">\n    Member <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a href="/me/posts/">My posts</a></li>\n    <li><a href="/me/setting/">Setting</a></li>\n    <li><a href="javascript:void(0)" class="button-logout">Logout</a></li>\n  </ul>\n</li>',this.parent.append(t)},guest:function(){var t;return t='<li class="dropdown" id="preview-menu">\n  <a class="dropdown-toggle" data-toggle="dropdown" href="#">\n    Login <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a href="javascript:void(0)" class="button-github-login">GitHub登入</a></li>\n    <li><a href="javascript:void(0)" class="button-facebook-login">Facebook登入</a></li>\n  </ul>\n</li>',this.parent.append(t)}},t.prototype.message={failed:function(t){var n;return n="<span>Load failed</span>",t.append(n)},failed_table:function(t,n){var e;return null==n&&(n=1),e='<tr>\n  <td colspan="'+n+'">\n    <span>Load failed</span>\n  </td>\n</tr>',t.append(e)},null_table:function(t,n,e){var i;return null==n&&(n=1),null==e&&(e=""),i='<tr>\n  <td colspan="'+n+'">\n    <span>No record. '+e+"</span>\n  </td>\n</tr>",t.append(i)},page_not_found:function(t){var n;return n='<div class="alert alert-block alert-danger text-center">\n  <img src="/images/old/shark.gif" /><br /><br />\n  <h4 class="alert-heading">Thiss paage isn avilabie</h4><br />\n  <p>\n    Tho likn yuo flolowed mav bi borken, orr tle pgae mya heva beem remvoed.\n    <br /><br />\n    Wi cann not doo amything fro yyu, pleese fcuk yurself or go home.\n  </p>\n  <br />\n</div>',t.append(n)}},t.prototype.like_button={create:function(t){return this.__view(t.id,t.likes,t.liked)},updateLikeCount:function(t,n,e,i,o){return null==i&&(i=!1),null==o&&(o=""),o+=this.__view(n,e,i),t.parent().replaceWith(o)},__view:function(t,n,e){var i;return null==e&&(e=!1),e=e?" btn-primary":"",i=e?TEXT.liked:TEXT.like,'<div class="like-wrapper">\n  <button type="button" class="btn'+e+' button-like" data-id="'+t+'">\n    <i class="fa fa-thumbs-o-up" aria-hidden="true"></i> '+i+'\n  </button>\n  <span class="post-likes-count">\n    '+n+TEXT.people_liked+"\n  </span>\n</div>"}},t}(),t.View=new e,n.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2]);